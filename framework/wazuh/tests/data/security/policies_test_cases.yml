---
get_policies:
  - params:
      policy_ids:
        - 100
        - 103
    result:
      affected_items:
        - id: 100
          name: wazuhPolicy
          policy:
            actions:
              - "*:*"
            resources:
              - "*:*"
            effect: allow
          roles:
            - 100
            - 101
            - 102
            - 105
          resource_type: user
        - id: 103
          name: administratorPolicy
          policy:
            actions:
              - agent:update
              - agent:delete
            effect: allow
            resources:
              - agent:id:*
          roles:
            - 103
            - 105
          resource_type: user
      failed_items: {}
  - params:
      policy_ids:
        - 102
        - 104
        - 105
        - 112
    result:
      affected_items:
        - id: 102
          name: technicalPolicy
          policy:
            actions:
              - agent:create
            effect: allow
            resources:
              - "*:*:*"
          roles:
            - 104
            - 105
          resource_type: user
        - id: 104
          name: normalPolicy
          policy:
            actions:
              - agent:update
              - agent:delete
            effect: deny
            resources:
              - agent:id:*
          roles:
            - 102
            - 103
            - 105
          resource_type: user
        - id: 105
          name: ossecPolicy
          policy:
            actions:
              - role:read
            effect: allow
            resources:
              - role:id:*
          roles:
            - 105
          resource_type: user
      failed_items:
        "4007":
          - 112
  - params:
      policy_ids:
        - 999
        - 800
        - 700
        - 600
    result:
      affected_items: []
      failed_items:
        "4007":
          - 999
          - 800
          - 700
          - 600
add_policy:
  - params:
      name: new_policy
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
    result:
      affected_items:
        - id: 112
          name: new_policy
          policy:
            actions:
              - agent:delete
            effect: allow
            resources:
              - agent:id:099
          roles: []
          resource_type: user
      failed_items: {}
  - params:
      name: ossecPolicy
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:098
    result:
      affected_items: []
      failed_items:
        "4009":
          - ossecPolicy
  - params:
      name: wazuhPolicy
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:097
    result:
      affected_items: []
      failed_items:
        "4009":
          - wazuhPolicy
update_policy:
  - params:
      policy_id:
        - 105
    result:
      affected_items: []
      failed_items:
        "4001":
          - 105
  - params:
      policy_id:
        - 105
      name: ossecPolicy1
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:097
    result:
      affected_items:
        - id: 105
          name: ossecPolicy1
          policy:
            actions:
              - agent:delete
            effect: allow
            resources:
              - agent:id:097
          roles:
            - 105
          resource_type: user
      failed_items: {}
  - params:
      policy_id:
        - 950
      name: normalPolicy2
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:098
    result:
      affected_items: []
      failed_items:
        "4007":
          - 950
  - params:
      policy_id:
        - 103
      name: normalPolicy
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:097
    result:
      affected_items: []
      failed_items:
        "4013":
          - 103
  - params:
      policy_id:
        - 1
      name: wazuhPolicy
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
    result:
      affected_items: []
      failed_items:
        "4008":
          - 1
  - params:
      policy_id:
        - 1
      name: wazuhPolicy
      resource_type: default
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
    result:
      affected_items: []
      failed_items:
        "4008":
          - 1
  - params:
      policy_id:
        - 110
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
    result:
      affected_items: []
      failed_items:
        "4008":
          - 110
  - params:
      policy_id:
        - 110
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
      resource_type: user
    result:
      affected_items: []
      failed_items:
        "4008":
          - 110
  - params:
      policy_id:
        - 110
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
      resource_type: protected
    result:
      affected_items: []
      failed_items:
        "4008":
          - 110
  - params:
      policy_id:
        - 110
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
      resource_type: default
    result:
      affected_items:
        - id: 110
          name: test
          policy:
            actions:
              - agent:delete
            effect: allow
            resources:
              - agent:id:099
          roles: []
          resource_type: default
      failed_items: {}
  - params:
      policy_id:
        - 111
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
    result:
      affected_items: []
      failed_items:
        "4026":
          - 111
  - params:
      policy_id:
        - 111
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
      resource_type: user
    result:
      affected_items: []
      failed_items:
        "4026":
          - 111
  - params:
      policy_id:
        - 111
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
      resource_type: protected
    result:
      affected_items:
        - id: 111
          name: test
          policy:
            actions:
              - agent:delete
            effect: allow
            resources:
              - agent:id:099
          roles: []
          resource_type: protected
      failed_items: {}
  - params:
      policy_id:
        - 111
      name: test
      policy:
        actions:
          - agent:delete
        effect: allow
        resources:
          - agent:id:099
      resource_type: default
    result:
      affected_items: []
      failed_items:
        "4026":
          - 111
remove_policies:
  - params:
      policy_ids:
        - 1
        - 103
    result:
      affected_items:
        - id: 103
          name: administratorPolicy
          policy:
            actions:
              - agent:update
              - agent:delete
            effect: allow
            resources:
              - agent:id:*
          roles:
            - 103
            - 105
          resource_type: user
      failed_items:
        "4008":
          - 1
  - params:
      policy_ids:
        - 102
        - 104
        - 105
        - 200
    result:
      affected_items:
        - id: 102
          name: technicalPolicy
          policy:
            actions:
              - agent:create
            effect: allow
            resources:
              - "*:*:*"
          roles:
            - 104
            - 105
          resource_type: user
        - id: 104
          name: normalPolicy
          policy:
            actions:
              - agent:update
              - agent:delete
            effect: deny
            resources:
              - agent:id:*
          roles:
            - 102
            - 103
            - 105
          resource_type: user
        - id: 105
          name: ossecPolicy
          policy:
            actions:
              - role:read
            effect: allow
            resources:
              - role:id:*
          roles:
            - 105
          resource_type: user
      failed_items:
        "4007":
          - 200
  - params:
      policy_ids:
        - 109
        - 901
        - 902
        - 903
    result:
      affected_items:
        - id: 109
          name: policy4
          policy:
            actions:
              - policy:delete
            effect: deny
            resources:
              - policy:id:*
          roles:
            - 104
            - 105
          resource_type: user
      failed_items:
        "4007":
          - 901
          - 902
          - 903
  - params:
      policy_ids:
        - 001
        - 109
        - 110
        - 111
    result:
      affected_items:
        - id: 109
          name: policy4
          policy:
            actions:
              - policy:delete
            effect: deny
            resources:
              - policy:id:*
          roles:
            - 104
            - 105
          resource_type: user
      failed_items:
        "4026":
          - 111
        "4008":
          - 001
          - 110
  - params:
      policy_ids:
        - 001
        - 109
        - 110
        - 111
      resource_type: user
    result:
      affected_items:
        - id: 109
          name: policy4
          policy:
            actions:
              - policy:delete
            effect: deny
            resources:
              - policy:id:*
          roles:
            - 104
            - 105
          resource_type: user
      failed_items:
        "4026":
          - 111
        "4008":
          - 001
          - 110
  - params:
      policy_ids:
        - 001
        - 109
        - 110
        - 111
      resource_type: protected
    result:
      affected_items:
        - id: 109
          name: policy4
          policy:
            actions:
              - policy:delete
            effect: deny
            resources:
              - policy:id:*
          roles:
            - 104
            - 105
          resource_type: user
        - id: 111
          name: protected
          policy:
            actions:
              - policy:read
            effect: deny
            resources:
              - policy:id:*
          roles: []
          resource_type: protected
      failed_items:
        "4008":
          - 001
          - 110
  - params:
      policy_ids:
        - 001
        - 109
        - 110
        - 111
      resource_type: default
    result:
      affected_items:
        - id: 109
          name: policy4
          policy:
            actions:
              - policy:delete
            effect: deny
            resources:
              - policy:id:*
          roles:
            - 104
            - 105
          resource_type: user
        - id: 110
          name: default
          policy:
            actions:
              - policy:delete
            effect: allow
            resources:
              - policy:id:*
          roles: []
          resource_type: default
      failed_items:
        "4026":
          - 111
        "4008":
          - 001
